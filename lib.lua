--
-- lib.lua
--
-- Copyright (c) 2015 Heachant, Tilmann Hars <headchant@headchant.com>
--
-- ALL RIGHTS RESERVED
--

--------------------------------------------------------------------------------
-- imports
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- init
--------------------------------------------------------------------------------

local lib = function()

--------------------------------------------------------------------------------
-- math
--------------------------------------------------------------------------------


mod = function(n, x)
	return (n%x)+1
end


--------------------------------------------------------------------------------
-- notes and tempo
--------------------------------------------------------------------------------

seconds = 44100

metro = function(time, func)
	local f 
	f = function()
		func()
		callback(now()+time, f)
	end
	f()
end

for_do = function(func, t)
	func(now())
	if  t > 0 then
		callback(now(), function() for_do(func, t-1) end)
	end
end

--------------------------------------------------------------------------------
-- audio and synths
--------------------------------------------------------------------------------

sinosc = function(freq, time)
	local sinc = freq * time * 2 * math.pi/44100
	out(math.sin(sinc))
end

ping = function(freq, time)
	local freq, time = freq or 440, time or 0.1
	for_do(function(k) sinosc(freq, k) end, seconds*time)
end

--------------------------------------------------------------------------------
-- return module
--------------------------------------------------------------------------------
end

return lib